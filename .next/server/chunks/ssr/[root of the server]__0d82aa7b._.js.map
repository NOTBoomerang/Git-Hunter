{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///Users/sanjithm/hunter-ai/src/lib/env-validation.ts"],"sourcesContent":["/**\n * Environment Variable Validation Utility\n * Helps users identify missing or invalid environment variables\n */\n\nexport interface EnvValidationResult {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n  suggestions: string[];\n}\n\nexport interface EnvConfig {\n  githubToken?: string;\n  openaiApiKey?: string;\n  githubApi?: string;\n  openaiModel?: string;\n}\n\n/**\n * Validates environment variables for the Git Hunter application\n */\nexport function validateEnvironment(): EnvValidationResult {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n  const suggestions: string[] = [];\n\n  // Check GitHub Token\n  const githubToken = process.env.NEXT_GITHUB_TOKEN;\n  if (!githubToken) {\n    errors.push('NEXT_GITHUB_TOKEN is not set');\n    suggestions.push('Add NEXT_GITHUB_TOKEN=your_github_token to your .env.local file');\n    suggestions.push('Create a GitHub Personal Access Token at https://github.com/settings/tokens');\n  } else if (githubToken.length < 20) {\n    warnings.push('NEXT_GITHUB_TOKEN appears to be too short (should be 40+ characters)');\n  } else if (!githubToken.startsWith('ghp_') && !githubToken.startsWith('github_pat_')) {\n    warnings.push('NEXT_GITHUB_TOKEN format may be invalid (should start with ghp_ or github_pat_)');\n  }\n\n  // Check OpenAI API Key\n  const openaiKey = process.env.NEXT_OPENAI_API_KEY;\n  if (!openaiKey) {\n    errors.push('NEXT_OPENAI_API_KEY is not set');\n    suggestions.push('Add NEXT_OPENAI_API_KEY=your_openai_key to your .env.local file');\n    suggestions.push('Get an OpenAI API key at https://platform.openai.com/api-keys');\n  } else if (openaiKey.length < 50) {\n    errors.push('NEXT_OPENAI_API_KEY appears to be too short or truncated');\n    suggestions.push('OpenAI API keys should be 51+ characters long and start with sk-proj- or sk-');\n  } else if (!openaiKey.startsWith('sk-proj-') && !openaiKey.startsWith('sk-')) {\n    warnings.push('NEXT_OPENAI_API_KEY format may be invalid (should start with sk-proj- or sk-)');\n  } else if (openaiKey.includes('...') || openaiKey.includes('truncated')) {\n    errors.push('NEXT_OPENAI_API_KEY appears to be truncated or incomplete');\n    suggestions.push('Make sure to copy the complete API key from OpenAI dashboard');\n  }\n\n  // Check optional configurations\n  const githubApi = process.env.NEXT_GITHUB_API;\n  if (githubApi && !githubApi.startsWith('https://')) {\n    warnings.push('NEXT_GITHUB_API should use HTTPS');\n  }\n\n  const openaiModel = process.env.OPENAI_MODEL;\n  if (openaiModel) {\n    const validModels = ['gpt-4', 'gpt-4-turbo', 'gpt-4o', 'gpt-4o-mini', 'gpt-3.5-turbo'];\n    if (!validModels.some(model => openaiModel.includes(model))) {\n      warnings.push(`OPENAI_MODEL '${openaiModel}' may not be supported. Recommended: ${validModels.join(', ')}`);\n    }\n  }\n\n  // Additional suggestions\n  if (errors.length === 0) {\n    suggestions.push('Consider setting up error monitoring for production deployments');\n    suggestions.push('Review rate limits for GitHub API and OpenAI API based on your usage');\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings,\n    suggestions\n  };\n}\n\n/**\n * Get current environment configuration (safe to log)\n */\nexport function getEnvironmentConfig(): EnvConfig {\n  const githubToken = process.env.NEXT_GITHUB_TOKEN;\n  const openaiApiKey = process.env.NEXT_OPENAI_API_KEY;\n  \n  return {\n    githubToken: githubToken ? `${githubToken.substring(0, 8)}...` : undefined,\n    openaiApiKey: openaiApiKey ? `${openaiApiKey.substring(0, 8)}...` : undefined,\n    githubApi: process.env.NEXT_GITHUB_API || 'https://api.github.com',\n    openaiModel: process.env.OPENAI_MODEL || 'gpt-4o-mini'\n  };\n}\n\n/**\n * Generate environment setup instructions\n */\nexport function generateSetupInstructions(validationResult: EnvValidationResult): string {\n  const instructions: string[] = [];\n  \n  instructions.push('# Git Hunter Environment Setup');\n  instructions.push('');\n  instructions.push('Create a .env.local file in your project root with the following variables:');\n  instructions.push('');\n  \n  if (validationResult.errors.some(e => e.includes('NEXT_GITHUB_TOKEN'))) {\n    instructions.push('# GitHub Personal Access Token (required)');\n    instructions.push('NEXT_GITHUB_TOKEN=your_github_token_here');\n    instructions.push('');\n  }\n  \n  if (validationResult.errors.some(e => e.includes('NEXT_OPENAI_API_KEY'))) {\n    instructions.push('# OpenAI API Key (required)');\n    instructions.push('NEXT_OPENAI_API_KEY=your_openai_api_key_here');\n    instructions.push('');\n  }\n  \n  instructions.push('# Optional configurations:');\n  instructions.push('# NEXT_GITHUB_API=https://api.github.com');\n  instructions.push('# OPENAI_MODEL=gpt-4o-mini');\n  instructions.push('# MAX_FILE_SIZE_BYTES=1048576');\n  instructions.push('# MAX_FILES=100');\n  instructions.push('');\n  instructions.push('## How to get tokens:');\n  instructions.push('');\n  instructions.push('### GitHub Token:');\n  instructions.push('1. Go to https://github.com/settings/tokens');\n  instructions.push('2. Click \"Generate new token (classic)\"');\n  instructions.push('3. Select \"repo\" scope for private repositories, or no scopes for public only');\n  instructions.push('4. Copy the generated token');\n  instructions.push('');\n  instructions.push('### OpenAI API Key:');\n  instructions.push('1. Go to https://platform.openai.com/api-keys');\n  instructions.push('2. Click \"Create new secret key\"');\n  instructions.push('3. Copy the generated key');\n  instructions.push('');\n  \n  return instructions.join('\\n');\n}\n\n/**\n * Validate environment on startup (server-side only)\n */\nexport function validateEnvironmentOnStartup(): void {\n  // Only run on server side\n  if (typeof window !== 'undefined') {\n    return;\n  }\n  \n  const validation = validateEnvironment();\n  const config = getEnvironmentConfig();\n  \n  console.log('\\nüîß Git Hunter Environment Check');\n  console.log('================================');\n  console.log(`GitHub Token: ${config.githubToken ? '‚úÖ Set' : '‚ùå Missing'}`);\n  console.log(`OpenAI API Key: ${config.openaiApiKey ? '‚úÖ Set' : '‚ùå Missing'}`);\n  console.log(`GitHub API: ${config.githubApi}`);\n  console.log(`OpenAI Model: ${config.openaiModel}`);\n  \n  if (validation.errors.length > 0) {\n    console.log('\\n‚ùå Configuration Errors:');\n    validation.errors.forEach(error => console.log(`  - ${error}`));\n  }\n  \n  if (validation.warnings.length > 0) {\n    console.log('\\n‚ö†Ô∏è Configuration Warnings:');\n    validation.warnings.forEach(warning => console.log(`  - ${warning}`));\n  }\n  \n  if (!validation.isValid) {\n    console.log('\\nüìù Setup Instructions:');\n    console.log(generateSetupInstructions(validation));\n  } else {\n    console.log('\\n‚úÖ Environment configuration looks good!');\n  }\n  \n  console.log('================================\\n');\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 302, "column": 0}, "map": {"version":3,"sources":["file:///Users/sanjithm/hunter-ai/src/app/actions.ts"],"sourcesContent":["\"use server\"\nimport axios from \"axios\";\nimport pLimit from \"p-limit\";\nimport { ChatOpenAI } from \"@langchain/openai\";\nimport { ChatPromptTemplate } from \"@langchain/core/prompts\";\nimport { JsonOutputParser } from \"@langchain/core/output_parsers\";\nimport { spawn } from \"child_process\";\nimport path from \"path\";\n\n/**\n * High-ROI defaults (override via env)\n */\nconst GITHUB_API = process.env.NEXT_GITHUB_API || \"https://api.github.com\";\nconst GITHUB_TOKEN = process.env.NEXT_GITHUB_TOKEN || \"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\";\nconst OPENAI_KEY = process.env.NEXT_OPENAI_API_KEY || \"\";\nconst OPENAI_MODEL = process.env.OPENAI_MODEL || \"gpt-3.5-turbo\";\nconst MAX_FILE_SIZE = Number(process.env.MAX_FILE_SIZE_BYTES || 1024 * 1024); // 1MB\nconst MAX_FILES = Number(process.env.MAX_FILES || 100);\nconst BATCH_DOWNLOAD_CONCURRENCY = Number(process.env.BATCH_DOWNLOAD_CONCURRENCY || 8); // Increased for faster downloads\nconst LINES_PER_CHUNK = Number(process.env.LINES_PER_CHUNK || 200);\n\n// Validate environment on server startup\nvalidateEnvironmentOnStartup();\n\n/* ----------------------------\n   Import Types from types.d.ts\n   ---------------------------- */\nimport type { \n  CodeSnippet, \n  Vulnerability, \n  ScanResult, \n  VulnerabilityCardContentType, \n  SemgrepFinding \n} from \"@/types\";\nimport { validateEnvironmentOnStartup } from \"@/lib/env-validation\";\n\n/* ----------------------------\n   Enhanced Semgrep Integration\n   ---------------------------- */\nexport async function runSemgrepAnalysis(repoPath: string): Promise<SemgrepFinding[]> {\n  return new Promise((resolve, reject) => {\n    console.log(`üîç Running enhanced Semgrep analysis on ${repoPath}...`);\n    \n    // Set up environment variables for the Python script\n    const env = {\n      ...process.env,\n      OPENAI_API_KEY: OPENAI_KEY,\n      PYTHONPATH: process.cwd()\n    };\n\n    const scriptPath = path.join(process.cwd(), 'semgrep_scanner.py');\n    \n    // Spawn Python process\n    const pythonProcess = spawn('python3', [scriptPath, repoPath], {\n      env,\n      cwd: process.cwd()\n    });\n\n    let stdout = '';\n    let stderr = '';\n\n    pythonProcess.stdout.on('data', (data) => {\n      stdout += data.toString();\n    });\n\n    pythonProcess.stderr.on('data', (data) => {\n      stderr += data.toString();\n    });\n\n    pythonProcess.on('close', (code) => {\n      if (code !== 0) {\n        console.error(`Python script exited with code ${code}`);\n        console.error(`stderr: ${stderr}`);\n        reject(new Error(`Semgrep analysis failed: ${stderr}`));\n        return;\n      }\n\n      try {\n        // Extract JSON from stdout (everything after the last line of dashes)\n        const lines = stdout.split('\\n');\n        let jsonStartIndex = -1;\n        \n        for (let i = lines.length - 1; i >= 0; i--) {\n          if (lines[i].includes('üìã SECURITY SCAN RESULTS') || lines[i].startsWith('[')) {\n            jsonStartIndex = lines[i].startsWith('[') ? i : i + 2;\n            break;\n          }\n        }\n        \n        if (jsonStartIndex === -1) {\n          // Look for any JSON array in the output\n          for (let i = 0; i < lines.length; i++) {\n            if (lines[i].trim().startsWith('[')) {\n              jsonStartIndex = i;\n              break;\n            }\n          }\n        }\n\n        if (jsonStartIndex !== -1) {\n          const jsonStr = lines.slice(jsonStartIndex).join('\\n');\n          const findings = JSON.parse(jsonStr);\n          console.log(`‚úÖ Parsed ${findings.length} Semgrep findings`);\n          resolve(findings);\n        } else {\n          console.log('No JSON findings found in output');\n          resolve([]);\n        }\n      } catch (error) {\n        console.error('Failed to parse Semgrep output:', error);\n        console.log('Raw output:', stdout);\n        resolve([]);\n      }\n    });\n\n    pythonProcess.on('error', (error) => {\n      console.error('Failed to start Python process:', error);\n      reject(error);\n    });\n\n    // Set timeout\n    setTimeout(() => {\n      pythonProcess.kill();\n      reject(new Error('Semgrep analysis timed out'));\n    }, 120000); // 2 minutes timeout\n  });\n}\n\n/* ----------------------------\n   Pure AI-Powered Security Analysis (No Hardcoded Patterns)\n   ---------------------------- */\n\nasync function analyzeCodeWithAI(snippet: CodeSnippet): Promise<Vulnerability[]> {\n  if (!OPENAI_KEY) {\n    throw new Error(\"OpenAI API key not configured. Please set NEXT_OPENAI_API_KEY in your environment variables to enable AI-powered security analysis.\");\n  }\n\n  console.log(`ü§ñ Running pure AI security analysis on ${snippet.name}`);\n  \n  const model = new ChatOpenAI({\n    model: OPENAI_MODEL,\n    temperature: 0,\n    openAIApiKey: OPENAI_KEY,\n  });\n\n  const enhancedSecurityPrompt = `You are an elite cybersecurity expert with decades of experience in vulnerability research and code auditing.\n\nMISSION: Perform a comprehensive security analysis of this code with forensic precision.\n\nCODE TO ANALYZE:\nFile: ${snippet.name}\nLanguage: ${snippet.language}\nSize: ${snippet.content.length} characters\n\n\\`\\`\\`${snippet.language}\n${snippet.content}\n\\`\\`\\`\n\nANALYSIS REQUIREMENTS:\n1. Examine EVERY line for security implications\n2. Consider data flow and execution paths\n3. Identify attack vectors and exploitation scenarios\n4. Assess business logic vulnerabilities\n5. Evaluate framework-specific security issues\n\nIMPORTANT: Only report vulnerabilities if you are highly confident they exist in the code. Do NOT report issues unless you can clearly identify them in the code. If you are unsure, do NOT report a vulnerability.\n\nVULNERABILITY CATEGORIES TO ASSESS:\nüî¥ CRITICAL: SQL Injection, Command Injection, Code Injection, Authentication Bypass\nüü† HIGH: XSS, Path Traversal, Hardcoded Secrets, Insecure Deserialization\nüü° MEDIUM: Weak Crypto, CSRF, Information Disclosure, Input Validation\n\nFor each vulnerability discovered, provide this EXACT JSON structure:\n[\n  {\n    \"severity\": \"medium|high|critical\",\n    \"title\": \"Concise vulnerability name (max 50 chars)\",\n    \"description\": \"Detailed technical explanation: What is the vulnerability? How can it be exploited? What's the impact? Include attack scenarios.\",\n    \"startLine\": line_number_where_vulnerability_starts,\n    \"endLine\": line_number_where_vulnerability_ends,\n    \"fix\": \"The FULL code with ALL vulnerabilities fixed, not just a generic example. The code should be the original code, but with all issues resolved in-place. If multiple vulnerabilities exist, the fix should show the code with all of them fixed together. Include necessary imports/dependencies if needed.\",\n    \"confidence\": confidence_score_0_to_1,\n    \"cwe\": \"CWE-XXX (if applicable)\",\n    \"owasp\": \"OWASP Top 10 category (if applicable)\",\n    \"attack_vector\": \"How an attacker would exploit this vulnerability\",\n    \"business_impact\": \"Real-world consequences of successful exploitation\"\n  }\n]\n\nCRITICAL INSTRUCTIONS:\n- Return ONLY valid JSON array\n- If no vulnerabilities found or if the descriptions is no issues found return: []\n- NO markdown formatting, NO extra text\n- In the 'fix' field, always return the full code with all vulnerabilities fixed, not just a generic example. The code should be updated in-place, not appended as comments at the bottom.\n- Be thorough but precise\n- Consider both obvious and subtle vulnerabilities\n- Look for logic flaws specific to the application context\n\nEXTRA VERIFICATION: Before reporting any vulnerability, use the Semgrep API (static analysis engine) to check if the issue is actually present in the code. Only report vulnerabilities that are confirmed by Semgrep or are extremely obvious in the code. If Semgrep does not confirm the issue, do NOT report it.`;\n\n  try {\n    const response = await model.invoke(enhancedSecurityPrompt);\n    const aiResponse = response.content as string;\n    \n    // Clean and parse AI response\n    let jsonStr = aiResponse.trim();\n    \n    // Remove any markdown formatting\n    if (jsonStr.startsWith('```')) {\n      jsonStr = jsonStr.replace(/```[a-z]*\\n?/g, '').replace(/```$/g, '');\n    }\n    \n    // Parse the JSON response\n    let aiVulnerabilities;\n    try {\n      aiVulnerabilities = JSON.parse(jsonStr);\n    } catch (jsonError) {\n      console.error(`JSON parsing failed for ${snippet.name}:`, jsonError);\n      console.error(`Raw AI response:`, aiResponse);\n      throw new Error(`AI analysis failed: Unable to parse security analysis results for ${snippet.name}`);\n    }\n    \n    // Convert to our internal Vulnerability format\n    const vulnerabilities: Vulnerability[] = aiVulnerabilities.map((v: any) => ({\n      severity: v.severity === 'critical' ? 'high' : (v.severity || \"medium\") as \"medium\" | \"high\",\n      title: v.title || \"Security Issue Detected\",\n      description: v.description || \"AI identified a potential security vulnerability\",\n      file: snippet.name,\n      startLine: v.startLine || 1,\n      endLine: v.endLine || v.startLine || 1,\n      fix: v.fix || \"Review code for security improvements\",\n      confidence: v.confidence || 0.85\n    }));\n    \n    console.log(`‚úÖ AI analysis complete: ${vulnerabilities.length} vulnerabilities found in ${snippet.name}`);\n    \n    // Log detailed results for debugging\n    if (vulnerabilities.length > 0) {\n      console.log(`üîç Vulnerabilities in ${snippet.name}:`, vulnerabilities.map(v => v.title));\n    }\n    \n    return vulnerabilities;\n    \n  } catch (error: any) {\n    console.error(`‚ùå Failed to analyze ${snippet.name}:`, error);\n    \n    // Handle specific OpenAI API errors\n    if (error?.message?.includes('rate limit')) {\n      throw new Error(`Rate limit exceeded. Please wait a moment and try again.`);\n    } else if (error?.message?.includes('insufficient_quota')) {\n      throw new Error(`OpenAI quota exceeded. Please check your OpenAI billing and usage limits.`);\n    } else if (error?.message?.includes('invalid_api_key')) {\n      throw new Error(`Invalid OpenAI API key. Please check your NEXT_OPENAI_API_KEY environment variable.`);\n    } else if (error?.message?.includes('model_not_found')) {\n      throw new Error(`OpenAI model not found. Please check your model configuration.`);\n    } else {\n      throw new Error(`AI security analysis failed for ${snippet.name}: ${error.message || 'Unknown error occurred'}`);\n    }\n  }\n}\n\n/* ----------------------------\n   fetchRepoFiles: uses git/trees for a single recursive listing\n   ---------------------------- */\nexport async function fetchRepoFiles(owner: string, repo: string, branch = \"master\"): Promise<CodeSnippet[]> {\n  if (!GITHUB_TOKEN) {\n    throw new Error(\"GitHub token not configured. Please set NEXT_GITHUB_TOKEN in your environment variables to access GitHub repositories.\");\n  }\n\n  // Step 1: get the SHA of the branch\n  let branchResp;\n  try {\n    branchResp = await axios.get(`${GITHUB_API}/repos/${owner}/${repo}/branches/${branch}`, {\n      headers: { Authorization: `token ${GITHUB_TOKEN}`, Accept: \"application/vnd.github.v3+json\" },\n      timeout: 10000,\n    });\n  } catch (e: any) {\n    const status = e?.response?.status;\n    if (status === 404) {\n      throw new Error(`Repository '${owner}/${repo}' not found or branch '${branch}' doesn't exist. Please check the repository URL and ensure it's publicly accessible.`);\n    } else if (status === 403) {\n      throw new Error(`Access denied to repository '${owner}/${repo}'. Please check your GitHub token permissions or ensure the repository is public.`);\n    } else if (status === 401) {\n      throw new Error(`GitHub authentication failed. Please check your NEXT_GITHUB_TOKEN environment variable.`);\n    } else if (e.code === 'ENOTFOUND' || e.code === 'ECONNREFUSED') {\n      throw new Error(`Network error: Unable to connect to GitHub. Please check your internet connection.`);\n    } else {\n      throw new Error(`Failed to fetch repository: ${e.message || 'Unknown error occurred'}`);\n    }\n  }\n\n  const commitSha = branchResp.data?.commit?.commit?.tree?.sha || branchResp.data?.commit?.sha;\n  if (!commitSha) {\n    throw new Error(\"Could not locate branch commit SHA.\");\n  }\n\n  // Step 2: get a recursive tree (single call)\n  let treeResp;\n  try {\n    treeResp = await axios.get(`${GITHUB_API}/repos/${owner}/${repo}/git/trees/${commitSha}?recursive=1`, {\n      headers: { Authorization: `token ${GITHUB_TOKEN}`, Accept: \"application/vnd.github.v3+json\" },\n      timeout: 20000,\n    });\n  } catch (e: any) {\n    if (e.code === 'ECONNABORTED') {\n      throw new Error(`Request timeout: The repository is too large or GitHub is responding slowly. Please try again later.`);\n    }\n    throw new Error(`Failed to fetch repository structure: ${e.message || 'Unknown error occurred'}`);\n  }\n\n  const items: any[] = treeResp.data?.tree || [];\n  const ALLOWED_EXT = /\\.(js|ts|py|java|php|rb|go|rs|jsx|tsx|mjs|cjs|env|config|conf|ini|xml|yaml|yml|json|txt)$/i;\n  const IGNORED_PATHS = [/node_modules/, /\\.gitignore/, /package-lock\\.json/, /^dist\\//, /^build\\//, /\\.DS_Store/];\n\n  const candidates = items\n    .filter((it) => it.type === \"blob\")\n    .filter((it) => ALLOWED_EXT.test(it.path) || /\\.env$/i.test(it.path) || /config/i.test(it.path))\n    .filter((it) => !IGNORED_PATHS.some((r) => r.test(it.path)))\n    .slice(0, MAX_FILES);\n\n  // Step 3: download files in limited concurrency\n  const limit = pLimit(BATCH_DOWNLOAD_CONCURRENCY);\n  const downloads = candidates.map((it) =>\n    limit(async (): Promise<CodeSnippet | null> => {\n      try {\n        if (it.size > MAX_FILE_SIZE) {\n          console.warn(`Skipping large file ${it.path} size=${it.size}`);\n          return null;\n        }\n        const rawUrl = `https://raw.githubusercontent.com/${owner}/${repo}/${branch}/${it.path}`;\n        const resp = await axios.get<string>(rawUrl, { timeout: 15000, responseType: \"text\", transformResponse: [(v: any) => v] });\n        return {\n          name: it.path,\n          path: it.path,\n          content: resp.data,\n          language: it.path.split(\".\").pop()?.toLowerCase() || \"txt\",\n          size: it.size,\n        };\n      } catch (err: any) {\n        console.warn(`Failed to fetch ${it.path}: ${err?.message || err}`);\n        return null;\n      }\n    })\n  );\n\n  const results = await Promise.all(downloads);\n  const final = results.filter(Boolean) as CodeSnippet[];\n  console.log(`Fetched ${final.length} files from ${owner}/${repo}`);\n  return final;\n}\n\n/* ----------------------------\n   chunkFileIntoRanges: split large files into chunks with line numbers\n   ---------------------------- */\nfunction chunkFileIntoRanges(snippet: CodeSnippet, linesPerChunk = LINES_PER_CHUNK) {\n  const lines = snippet.content.split(/\\r?\\n/);\n  const chunks: { text: string; startLine: number; endLine: number; file: string }[] = [];\n  for (let i = 0; i < lines.length; i += linesPerChunk) {\n    const start = i + 1;\n    const end = Math.min(i + linesPerChunk, lines.length);\n    const text = lines.slice(i, end).join(\"\\n\");\n    chunks.push({ text, startLine: start, endLine: end, file: snippet.name });\n  }\n  return chunks;\n}\n\n/* ----------------------------\n   AI-Powered Security Scan (replaces basic regex patterns)\n   ---------------------------- */\nexport async function cheapPreScan(snippet: CodeSnippet): Promise<Vulnerability[]> {\n  console.log(`üîç Starting security analysis for ${snippet.name}...`);\n  \n  // Try AI-powered analysis first, fallback to pattern-based if it fails\n  try {\n    console.log(`ü§ñ Attempting AI security analysis...`);\n    return await analyzeCodeWithAI(snippet);\n  } catch (aiError: any) {\n    console.warn(`‚ö†Ô∏è AI analysis failed for ${snippet.name}: ${aiError.message}`);\n    console.log(`üîç Falling back to pattern-based security analysis...`);\n    return await fallbackPatternAnalysis(snippet);\n  }\n}\n\n/* ----------------------------\n   Fallback Pattern-Based Security Analysis\n   Used when AI analysis is not available\n   ---------------------------- */\n\nasync function fallbackPatternAnalysis(snippet: CodeSnippet): Promise<Vulnerability[]> {\n  console.log(`üîç Running pattern-based security analysis on ${snippet.name}`);\n  const vulnerabilities: Vulnerability[] = [];\n  const content = snippet.content.toLowerCase();\n  const lines = snippet.content.split(/\\r?\\n/);\n\n  // SQL Injection patterns\n  const sqlInjectionPatterns = [\n    /\\$\\{[^}]*\\}/g, // Template literals in SQL\n    /[\"'][^\"']*\\+[^\"']*[\"']/g, // String concatenation\n    /query\\s*\\+\\s*[\"']/gi, // Query concatenation\n    /execute\\s*\\([^)]*\\+/gi, // Execute with concatenation\n    /SELECT\\s+.*\\+/gi, // SELECT with concatenation\n    /INSERT\\s+.*\\+/gi, // INSERT with concatenation\n    /UPDATE\\s+.*\\+/gi, // UPDATE with concatenation\n    /DELETE\\s+.*\\+/gi, // DELETE with concatenation\n  ];\n\n  // XSS patterns\n  const xssPatterns = [\n    /innerHTML\\s*=\\s*[^\"']*\\+/gi, // innerHTML with concatenation\n    /document\\.write\\s*\\([^)]*\\+/gi, // document.write with concatenation\n    /\\.html\\s*\\([^)]*\\+/gi, // .html() with concatenation\n    /eval\\s*\\(/gi, // eval() usage\n    /setTimeout\\s*\\([\"'][^\"']*\\+/gi, // setTimeout with string concat\n    /setInterval\\s*\\([\"'][^\"']*\\+/gi, // setInterval with string concat\n  ];\n\n  // Command Injection patterns\n  const commandInjectionPatterns = [\n    /exec\\s*\\([^)]*\\+/gi, // exec with concatenation\n    /spawn\\s*\\([^)]*\\+/gi, // spawn with concatenation\n    /system\\s*\\([^)]*\\+/gi, // system with concatenation\n    /shell_exec\\s*\\([^)]*\\+/gi, // shell_exec with concatenation\n    /passthru\\s*\\([^)]*\\+/gi, // passthru with concatenation\n  ];\n\n  // Hardcoded secrets patterns\n  const secretPatterns = [\n    /(api[_-]?key|apikey)\\s*[:=]\\s*[\"'][^\"']{10,}[\"']/gi,\n    /(secret|password|pwd|pass)\\s*[:=]\\s*[\"'][^\"']{3,}[\"']/gi,\n    /(token|auth[_-]?token)\\s*[:=]\\s*[\"'][^\"']{10,}[\"']/gi,\n    /sk-[a-zA-Z0-9]{20,}/g, // OpenAI API keys\n    /ghp_[a-zA-Z0-9]{36}/g, // GitHub tokens\n    /AIza[a-zA-Z0-9_-]{35}/g, // Google API keys\n    /AKIA[a-zA-Z0-9]{16}/g, // AWS Access Keys\n  ];\n\n  // Path Traversal patterns\n  const pathTraversalPatterns = [\n    /\\.\\.\\/|\\.\\.\\\\/g, // Directory traversal\n    /\\$_GET\\[.*\\].*file/gi, // PHP file inclusion\n    /\\$_POST\\[.*\\].*file/gi, // PHP file inclusion\n    /include\\s*\\([^)]*\\$_/gi, // PHP include with user input\n    /require\\s*\\([^)]*\\$_/gi, // PHP require with user input\n    /readFile\\s*\\([^)]*\\+/gi, // File read with concatenation\n  ];\n\n  // Weak crypto patterns\n  const weakCryptoPatterns = [\n    /md5\\s*\\(/gi, // MD5 usage\n    /sha1\\s*\\(/gi, // SHA1 usage\n    /base64_encode\\s*\\(/gi, // Base64 encoding (not encryption)\n    /DES|3DES|RC4/gi, // Weak encryption algorithms\n  ];\n\n  // Check SQL Injection\n  for (const pattern of sqlInjectionPatterns) {\n    const matches = snippet.content.match(pattern);\n    if (matches) {\n      vulnerabilities.push({\n        severity: \"high\",\n        title: \"Potential SQL Injection\",\n        description: `SQL injection vulnerability detected. The code appears to concatenate user input directly into SQL queries. Found pattern: ${matches[0]}. This could allow attackers to manipulate database queries and access sensitive data.`,\n        file: snippet.name,\n        startLine: findLineNumber(lines, matches[0]),\n        endLine: findLineNumber(lines, matches[0]),\n        fix: \"Use parameterized queries or prepared statements instead of string concatenation. Example: db.query('SELECT * FROM users WHERE id = ?', [userId]);\",\n        confidence: 0.8\n      });\n    }\n  }\n\n  // Check XSS\n  for (const pattern of xssPatterns) {\n    const matches = snippet.content.match(pattern);\n    if (matches) {\n      vulnerabilities.push({\n        severity: \"high\",\n        title: \"Potential Cross-Site Scripting (XSS)\",\n        description: `XSS vulnerability detected. The code appears to insert user data directly into HTML without proper sanitization. Found pattern: ${matches[0]}. This could allow attackers to execute malicious scripts in users' browsers.`,\n        file: snippet.name,\n        startLine: findLineNumber(lines, matches[0]),\n        endLine: findLineNumber(lines, matches[0]),\n        fix: \"Always sanitize user input before inserting into HTML. Use proper encoding functions or libraries like DOMPurify for HTML sanitization.\",\n        confidence: 0.8\n      });\n    }\n  }\n\n  // Check Command Injection\n  for (const pattern of commandInjectionPatterns) {\n    const matches = snippet.content.match(pattern);\n    if (matches) {\n      vulnerabilities.push({\n        severity: \"high\",\n        title: \"Potential Command Injection\",\n        description: `Command injection vulnerability detected. The code appears to execute system commands with user input. Found pattern: ${matches[0]}. This could allow attackers to execute arbitrary commands on the server.`,\n        file: snippet.name,\n        startLine: findLineNumber(lines, matches[0]),\n        endLine: findLineNumber(lines, matches[0]),\n        fix: \"Avoid executing system commands with user input. If necessary, use whitelisting and proper input validation. Consider using safer alternatives or libraries.\",\n        confidence: 0.9\n      });\n    }\n  }\n\n  // Check Hardcoded Secrets\n  for (const pattern of secretPatterns) {\n    const matches = snippet.content.match(pattern);\n    if (matches) {\n      vulnerabilities.push({\n        severity: \"high\",\n        title: \"Hardcoded Secrets Detected\",\n        description: `Hardcoded secrets or credentials found in the code. This is a critical security issue as sensitive information should never be stored in source code. Detected: ${matches[0].substring(0, 30)}...`,\n        file: snippet.name,\n        startLine: findLineNumber(lines, matches[0]),\n        endLine: findLineNumber(lines, matches[0]),\n        fix: \"Move all secrets to environment variables or a secure secrets management system. Use process.env.SECRET_NAME to access them at runtime.\",\n        confidence: 0.95\n      });\n    }\n  }\n\n  // Check Path Traversal\n  for (const pattern of pathTraversalPatterns) {\n    const matches = snippet.content.match(pattern);\n    if (matches) {\n      vulnerabilities.push({\n        severity: \"medium\",\n        title: \"Potential Path Traversal\",\n        description: `Path traversal vulnerability detected. The code may allow access to files outside the intended directory. Found pattern: ${matches[0]}. This could lead to unauthorized file access.`,\n        file: snippet.name,\n        startLine: findLineNumber(lines, matches[0]),\n        endLine: findLineNumber(lines, matches[0]),\n        fix: \"Validate and sanitize all file paths. Use path.resolve() and path.basename() to prevent directory traversal. Implement proper access controls.\",\n        confidence: 0.7\n      });\n    }\n  }\n\n  // Check Weak Crypto\n  for (const pattern of weakCryptoPatterns) {\n    const matches = snippet.content.match(pattern);\n    if (matches) {\n      vulnerabilities.push({\n        severity: \"medium\",\n        title: \"Weak Cryptographic Algorithm\",\n        description: `Weak cryptographic algorithm detected: ${matches[0]}. These algorithms are considered insecure and should not be used for security-sensitive operations.`,\n        file: snippet.name,\n        startLine: findLineNumber(lines, matches[0]),\n        endLine: findLineNumber(lines, matches[0]),\n        fix: \"Use strong cryptographic algorithms like SHA-256, AES, or bcrypt. For password hashing, use bcrypt, scrypt, or Argon2.\",\n        confidence: 0.9\n      });\n    }\n  }\n\n  console.log(`‚úÖ Pattern-based analysis complete: ${vulnerabilities.length} vulnerabilities found in ${snippet.name}`);\n  return vulnerabilities;\n}\n\n// Helper function to find line number of a pattern match\nfunction findLineNumber(lines: string[], pattern: string): number {\n  for (let i = 0; i < lines.length; i++) {\n    if (lines[i].includes(pattern.substring(0, 20))) {\n      return i + 1;\n    }\n  }\n  return 1;\n}\n\n/* ----------------------------\n   Intelligent Dual-Engine Security Analysis (AI + Semgrep)\n   No hardcoded patterns - Pure AI intelligence\n   ---------------------------- */\nexport async function scanRepoFiles(snippets: CodeSnippet[], useEnhancedScan: boolean = true): Promise<ScanResult[]> {\n  if (!OPENAI_KEY) {\n    throw new Error(\"üö® OpenAI API key required for security analysis. This scanner relies on AI intelligence, not hardcoded patterns.\");\n  }\n\n  const startTime = Date.now();\n  console.log(`üöÄ OPTIMIZED: Starting performance-tuned security analysis of ${snippets.length} files...`);\n\n  console.log(`ÔøΩÔ∏è Starting intelligent security analysis of ${snippets.length} files...`);\n  console.log(`üîß Analysis engines: ${useEnhancedScan ? 'AI + Semgrep (Enhanced)' : 'AI Only'}`);\n\n  // Quick pre-filter for obviously safe files to improve performance\n  const relevantFiles = snippets.filter(s => {\n    // Skip documentation and non-code files\n  if (/\\.(txt|json|lock|gitignore|png|jpg|svg|ico|gif|woff|ttf|eot|pdf|log|xml|yml|yaml|csv|dat)$/i.test(s.name)) return false;\n    \n    // Skip specific non-security files\n    if (/^(readme|license|changelog|contributing|code_of_conduct|package-lock|yarn\\.lock|gemfile\\.lock)/i.test(s.name)) return false;\n    \n    // Skip oversized files (likely minified or binary)\n    if (s.size && s.size > MAX_FILE_SIZE) return false;\n    \n    // Only include actual code files that need security analysis\n    const codeFilePattern = /\\.(js|ts|jsx|tsx|py|java|php|rb|go|rs|c|cpp|cs|scala|kt|swift|dart|sh|bash|zsh|ps1|sql|pl|r|m|mm|h|hpp|cc|cxx)$/i;\n    return codeFilePattern.test(s.name);\n  });\n\n  console.log(`üìä Filtered to ${relevantFiles.length} relevant files for analysis`);\n\n  // Smart Semgrep usage - skip for very large repositories to save time\n  const shouldUseSemgrep = useEnhancedScan && relevantFiles.length <= 25;\n  if (useEnhancedScan && !shouldUseSemgrep) {\n    console.log(`‚ö° Skipping Semgrep for large repository (${relevantFiles.length} files) - using AI-only for speed`);\n  }\n\n  // PARALLEL EXECUTION: Run both analyses simultaneously\n  const analysisPromises = [];\n\n  // 1. Optimized AI Analysis (always runs)\n  console.log(`ü§ñ Starting optimized batch AI analysis...`);\n  const aiAnalysisPromise = analyzeAllFilesWithAI(relevantFiles);\n  analysisPromises.push(aiAnalysisPromise);\n\n  // 2. Smart Semgrep Analysis (only for smaller repositories)\n  let semgrepPromise: Promise<SemgrepFinding[]> = Promise.resolve([]);\n  if (shouldUseSemgrep) {\n    console.log(`‚ö° Starting parallel Semgrep analysis on ${relevantFiles.length} files...`);\n    semgrepPromise = runFullSemgrepAnalysis(relevantFiles);\n    analysisPromises.push(semgrepPromise);\n  }\n\n  // Wait for both analyses to complete\n  const [aiResults, semgrepFindings] = await Promise.all([\n    aiAnalysisPromise,\n    semgrepPromise\n  ]);\n\n  // INTELLIGENT MERGE: Combine results with deduplication\n  const finalResults = mergeIntelligentFindings(aiResults, semgrepFindings);\n\n  const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);\n  console.log(`‚úÖ OPTIMIZED: Analysis complete in ${elapsed}s`);\n  console.log(`üìä Results: AI found ${aiResults.length} files, Semgrep found ${semgrepFindings.length} findings`);\n  console.log(`üéØ Final: ${finalResults.length} files with security issues identified`);\n  \n  return finalResults;\n}\n\n/* ----------------------------\n   PERFORMANCE OPTIMIZED AI Analysis - Batch Processing\n   ---------------------------- */\nasync function analyzeAllFilesWithAI(snippets: CodeSnippet[]): Promise<ScanResult[]> {\n  // Smart pre-filtering for performance\n  const criticalFiles = filterCriticalFiles(snippets);\n  \n  console.log(`üöÄ OPTIMIZED: Analyzing ${criticalFiles.length}/${snippets.length} critical files`);\n  \n  if (criticalFiles.length === 0) {\n    console.log(\"‚úÖ No critical files found for AI analysis\");\n    return [];\n  }\n\n  // Batch files for more efficient API usage\n  return await batchAnalyzeWithAI(criticalFiles);\n}\n\n/* ----------------------------\n   Smart File Filtering - Skip non-security-relevant files\n   ---------------------------- */\nfunction filterCriticalFiles(snippets: CodeSnippet[]): CodeSnippet[] {\n  const SKIP_FILES = /\\.(txt|json|lock|png|jpg|gif|ico|svg|woff|ttf|eot|pdf|zip|tar|gz|log|bak|tmp|xml|yml|yaml|csv|dat)$/i;\n  const PRIORITY_FILES = /\\.(js|ts|py|php|java|rb|go|jsx|tsx|vue|swift|kt|scala|cs|cpp|c|h|sql|sh)$/i;\n  \n  return snippets.filter(snippet => {\n    // Skip obviously safe files\n    if (SKIP_FILES.test(snippet.name)) return false;\n    \n    // Skip huge files (likely to be minified or generated)\n    if (snippet.size && snippet.size > 100000) return false;\n    \n    // Skip tiny files unless they're priority types\n    if (snippet.size && snippet.size < 50 && !PRIORITY_FILES.test(snippet.name)) return false;\n    \n    // Include if it's a priority file type\n    if (PRIORITY_FILES.test(snippet.name)) return true;\n    \n    // Include if content suggests security relevance\n    const securityKeywords = ['password', 'secret', 'key', 'token', 'auth', 'eval(', 'exec(', 'SELECT ', 'INSERT ', 'DELETE ', 'UPDATE '];\n    const hasSecurityKeywords = securityKeywords.some(keyword => \n      snippet.content.toLowerCase().includes(keyword.toLowerCase())\n    );\n    \n    return hasSecurityKeywords;\n  });\n}\n\n/* ----------------------------\n   Batch AI Analysis - Multiple files per API call\n   ---------------------------- */\nasync function batchAnalyzeWithAI(snippets: CodeSnippet[]): Promise<ScanResult[]> {\n  const BATCH_SIZE = 3; // Analyze 3 files per AI call for efficiency\n  const batches: CodeSnippet[][] = [];\n  \n  // Create batches of files\n  for (let i = 0; i < snippets.length; i += BATCH_SIZE) {\n    batches.push(snippets.slice(i, i + BATCH_SIZE));\n  }\n\n  console.log(`üîÑ Processing ${batches.length} batches (${BATCH_SIZE} files each)`);\n\n  // Process batches with reduced concurrency for stability\n  const limit = pLimit(2); // Reduced for better performance and rate limit compliance\n  const allResults: ScanResult[] = [];\n\n  const batchPromises = batches.map((batch, batchIndex) =>\n    limit(async () => {\n      try {\n        console.log(`üì¶ Processing batch ${batchIndex + 1}/${batches.length}`);\n        const batchResults = await analyzeBatchWithAI(batch);\n        return batchResults;\n      } catch (error) {\n        console.error(`‚ùå Batch ${batchIndex + 1} analysis failed:`, error);\n        return [];\n      }\n    })\n  );\n\n  const allBatchResults = await Promise.all(batchPromises);\n  return allBatchResults.flat();\n}\n\n/* ----------------------------\n   Single Batch AI Analysis - Analyzes multiple files in one API call\n   ---------------------------- */\nasync function analyzeBatchWithAI(batch: CodeSnippet[]): Promise<ScanResult[]> {\n  if (!OPENAI_KEY) return [];\n\n  const model = new ChatOpenAI({\n    model: OPENAI_MODEL,\n    temperature: 0,\n    openAIApiKey: OPENAI_KEY,\n  });\n\n  // Create combined prompt for multiple files\n  const filesContent = batch.map((snippet, idx) => \n    `FILE_${idx + 1}: ${snippet.name}\nLanguage: ${snippet.language}\n\\`\\`\\`${snippet.language}\n${snippet.content.slice(0, 8000)} ${snippet.content.length > 8000 ? '... (truncated)' : ''}\n\\`\\`\\`\n`).join('\\n' + '='.repeat(50) + '\\n');\n\n  const batchPrompt = `You are an elite cybersecurity expert. Analyze these ${batch.length} files for security vulnerabilities.\n\nFor each file that has vulnerabilities, return them in this EXACT JSON structure:\n{\n  \"results\": {\n    \"${batch[0].name}\": [\n      {\n        \"severity\": \"low|medium|high\",\n        \"title\": \"Vulnerability name (max 50 chars)\",\n        \"description\": \"Detailed explanation of the vulnerability and how it can be exploited\",\n        \"startLine\": line_number,\n        \"endLine\": line_number,\n        \"fix\": \"Complete secure code example or detailed fix instructions\",\n        \"confidence\": confidence_score_0_to_1\n      }\n    ],\n    \"${batch[1]?.name || 'file2.ext'}\": [],\n    \"${batch[2]?.name || 'file3.ext'}\": []\n  }\n}\n\nCRITICAL: \n- Return ONLY the JSON object, no extra text\n- If a file has no vulnerabilities, use empty array []\n- Focus on: SQL Injection, XSS, Command Injection, Hardcoded Secrets, Path Traversal, Code Injection, Weak Crypto\n\nFILES TO ANALYZE:\n${filesContent}`;\n\n  try {\n    const response = await model.invoke(batchPrompt);\n    const aiResponse = response.content as string;\n    \n    // Clean and parse AI response\n    let jsonStr = aiResponse.trim();\n    if (jsonStr.startsWith('```')) {\n      jsonStr = jsonStr.replace(/```[a-z]*\\n?/g, '').replace(/```$/g, '');\n    }\n    \n    const batchResults = JSON.parse(jsonStr);\n    const scanResults: ScanResult[] = [];\n    \n    // Convert batch results to ScanResult format\n    const results = batchResults.results || batchResults;\n    for (const [fileName, vulnerabilities] of Object.entries(results)) {\n      if (Array.isArray(vulnerabilities) && vulnerabilities.length > 0) {\n        const formattedVulns = vulnerabilities.map((v: any) => ({\n          severity: v.severity === 'critical' ? 'high' : (v.severity || \"medium\") as \"low\" | \"medium\" | \"high\",\n          title: v.title || \"Security Issue Detected\",\n          description: v.description || \"AI identified a potential security vulnerability\",\n          file: fileName,\n          startLine: v.startLine || 1,\n          endLine: v.endLine || v.startLine || 1,\n          fix: v.fix || \"Review code for security improvements\",\n          confidence: v.confidence || 0.85\n        }));\n        \n        scanResults.push({\n          file: fileName,\n          vulnerabilities: formattedVulns\n        });\n      }\n    }\n    \n    console.log(`‚úÖ Batch analysis: ${scanResults.length} files with vulnerabilities found`);\n    return scanResults;\n    \n  } catch (error) {\n    console.error(`‚ùå Batch AI analysis failed:`, error);\n    // Fallback to individual analysis if batch fails\n    console.log(`üîÑ Falling back to individual file analysis for batch`);\n    return await fallbackIndividualAnalysis(batch);\n  }\n}\n\n/* ----------------------------\n   Fallback Individual Analysis - Used when batch analysis fails\n   ---------------------------- */\nasync function fallbackIndividualAnalysis(batch: CodeSnippet[]): Promise<ScanResult[]> {\n  const results: ScanResult[] = [];\n  \n  for (const snippet of batch) {\n    try {\n      const vulnerabilities = await analyzeCodeWithAI(snippet);\n      if (vulnerabilities.length > 0) {\n        results.push({ file: snippet.name, vulnerabilities });\n      }\n    } catch (error) {\n      console.error(`‚ùå Individual analysis failed for ${snippet.name}:`, error);\n    }\n  }\n  \n  return results;\n}\n\n/* ----------------------------\n   Semgrep Analysis Engine - Professional static analysis\n   ---------------------------- */\nasync function runFullSemgrepAnalysis(snippets: CodeSnippet[]): Promise<SemgrepFinding[]> {\n  try {\n    // Create temporary directory with all repository files\n    const tempDir = await createTempRepoDir(snippets);\n    \n    // Run comprehensive Semgrep analysis\n    const semgrepFindings = await runSemgrepAnalysis(tempDir);\n    \n    console.log(`üîç Semgrep analysis complete: ${semgrepFindings.length} findings`);\n    return semgrepFindings;\n    \n  } catch (error) {\n    console.error(`‚ùå Semgrep analysis failed:`, error);\n    throw error; // No fallback - fail fast\n  }\n}\n\n/* ----------------------------\n   Intelligent Results Merger - Combines AI + Semgrep with smart deduplication\n   ---------------------------- */\nfunction mergeIntelligentFindings(aiResults: ScanResult[], semgrepFindings: SemgrepFinding[]): ScanResult[] {\n  const mergedResults = new Map<string, ScanResult>();\n\n  // Add all AI findings first\n  for (const result of aiResults) {\n    mergedResults.set(result.file, result);\n  }\n\n  // Integrate Semgrep findings\n  for (const semgrepFinding of semgrepFindings) {\n    // Find matching file\n    const fileName = semgrepFinding.file.split('/').pop() || semgrepFinding.file;\n    const matchingFile = Array.from(mergedResults.keys()).find(key => \n      key.endsWith(fileName) || key === semgrepFinding.file\n    ) || fileName;\n\n    // Convert Semgrep finding to Vulnerability format\n    const semgrepVuln: Vulnerability = {\n      severity: mapSemgrepSeverity(semgrepFinding.severity),\n      title: formatSemgrepTitle(semgrepFinding.issue),\n      description: semgrepFinding.description,\n      file: matchingFile,\n      startLine: semgrepFinding.line,\n      endLine: semgrepFinding.line,\n      fix: semgrepFinding.secure_code_fix,\n      confidence: 0.95 // Semgrep has high confidence\n    };\n\n    // Add or merge with existing results\n    if (mergedResults.has(matchingFile)) {\n      const existing = mergedResults.get(matchingFile)!;\n      \n      // Check for duplicates (same vulnerability type and line)\n      const isDuplicate = existing.vulnerabilities.some(v => \n        v.title === semgrepVuln.title && \n        Math.abs((v.startLine || 0) - (semgrepVuln.startLine || 0)) <= 2\n      );\n\n      if (!isDuplicate) {\n        existing.vulnerabilities.push(semgrepVuln);\n      }\n    } else {\n      mergedResults.set(matchingFile, {\n        file: matchingFile,\n        vulnerabilities: [semgrepVuln]\n      });\n    }\n  }\n\n  return Array.from(mergedResults.values());\n}\n\n\nfunction mapSemgrepSeverity(severity: string): \"low\" | \"medium\" | \"high\" {\n  const severityMap: Record<string, \"low\" | \"medium\" | \"high\"> = {\n    'ERROR': 'high',\n    'WARNING': 'medium', \n    'INFO': 'low',\n    'HIGH': 'high',\n    'MEDIUM': 'medium',\n    'LOW': 'low'\n  };\n  return severityMap[severity.toUpperCase()] || 'medium';\n}\n\nfunction formatSemgrepTitle(issue: string): string {\n  return issue\n    .replace(/_/g, ' ')\n    .replace(/\\b\\w/g, l => l.toUpperCase())\n    .replace(/\\s+/g, ' ')\n    .trim();\n}\n\n\nasync function createTempRepoDir(snippets: CodeSnippet[]): Promise<string> {\n  const fs = await import('fs/promises');\n  const os = await import('os');\n  const path = await import('path');\n  \n  \n  const tempDir = await fs.mkdtemp(path.join(os.tmpdir(), 'semgrep-scan-'));\n  \n  \n  for (const snippet of snippets) {\n    const filePath = path.join(tempDir, snippet.name);\n    const dirPath = path.dirname(filePath);\n    \n    \n    await fs.mkdir(dirPath, { recursive: true });\n    \n    \n    await fs.writeFile(filePath, snippet.content, 'utf8');\n  }\n  \n  console.log(`üìÅ Created temporary repository at ${tempDir}`);\n  return tempDir;\n}\n\n\nexport async function debugEnvironment() {\n  return {\n    hasGithubToken: !!GITHUB_TOKEN,\n    hasOpenAiKey: !!OPENAI_KEY,\n    githubApi: GITHUB_API,\n    openaiModel: OPENAI_MODEL,\n    githubTokenPreview: GITHUB_TOKEN ? `${GITHUB_TOKEN.substring(0, 10)}...` : \"Not set\",\n    openaiKeyPreview: OPENAI_KEY ? `${OPENAI_KEY.substring(0, 10)}...` : \"Not set\"\n  };\n}\n\n\nexport async function checkCodeSecurity(code: string): Promise<{ \n  isSecure: boolean; \n  vulnerabilities: Vulnerability[] \n}> {\n  const snippet: CodeSnippet = {\n    name: \"input.js\",\n    path: \"input.js\",\n    content: code,\n    language: \"javascript\",\n    size: code.length\n  };\n  \n  const vulnerabilities = await cheapPreScan(snippet);\n  return {\n    isSecure: vulnerabilities.length === 0,\n    vulnerabilities\n  };\n}\n\nexport async function scanVulnerability(code: string): Promise<VulnerabilityCardContentType & { correctCode: string }> {\n  console.log(\"üîç scanVulnerability called with code length:\", code.length);\n  console.log(\"üîë Environment check - OPENAI_KEY exists:\", !!OPENAI_KEY);\n  console.log(\"üîë Environment check - GITHUB_TOKEN exists:\", !!GITHUB_TOKEN);\n  \n  const snippet: CodeSnippet = {\n    name: \"temp.js\",\n    path: \"temp.js\", \n    content: code,\n    language: \"javascript\",\n    size: code.length\n  };\n  \n  const vulnerabilities = await cheapPreScan(snippet);\n  console.log(\"üìã Found vulnerabilities:\", vulnerabilities.length);\n  \n  if (vulnerabilities.length === 0) {\n    return {\n      riskLevel: \"low\",\n      riskTitle: \"No Issues Found\", \n      riskDescription: \"The code appears to be secure based on our analysis.\",\n      correctCode: code\n    };\n  }\n  \n  const highestSeverity = vulnerabilities.reduce((highest, curr) => {\n    const severityOrder = { low: 1, medium: 2, high: 3 };\n    return severityOrder[curr.severity] > severityOrder[highest.severity] ? curr : highest;\n  });\n  \n\n  const secureCodeFix = generateSecureCodeFix(code, highestSeverity);\n  \n  return {\n    riskLevel: highestSeverity.severity,\n    riskTitle: highestSeverity.title,\n    riskDescription: getDetailedDescription(highestSeverity, code),\n    correctCode: secureCodeFix\n  };\n}\n\nfunction getDetailedDescription(vulnerability: Vulnerability, originalCode: string): string {\n  const descriptions: Record<string, string> = {\n    \"hardcoded_secrets\": `This code contains hardcoded sensitive information (API keys, passwords, tokens, or secrets) directly in the source code. This is a critical security vulnerability because:\n\n‚Ä¢ Secrets are visible to anyone with access to the code\n‚Ä¢ Version control systems store these secrets permanently  \n‚Ä¢ Deployed applications expose secrets in plain text\n‚Ä¢ Attackers can extract and misuse these credentials\n\nThe detected pattern suggests sensitive data is embedded directly in the code rather than being loaded from secure environment variables or a secrets management system.`,\n\n    \"sql_string_interp\": `This code uses string interpolation to build SQL queries, making it vulnerable to SQL injection attacks. This occurs when user input is directly concatenated into SQL statements without proper sanitization:\n\n‚Ä¢ Attackers can inject malicious SQL code through input parameters\n‚Ä¢ Database contents can be read, modified, or deleted\n‚Ä¢ Administrative access to the database may be compromised\n‚Ä¢ Application logic can be bypassed\n\nThe vulnerability allows attackers to manipulate the SQL query structure by providing specially crafted input values.`,\n\n    \"eval_os_system\": `This code uses dynamic code execution functions (eval, system, exec) which can lead to remote code execution vulnerabilities:\n\n‚Ä¢ Attackers can execute arbitrary code on the server\n‚Ä¢ System commands can be injected and executed\n‚Ä¢ Full system compromise is possible\n‚Ä¢ Application sandbox can be escaped\n\nThese functions should never process untrusted input as they interpret and execute the input as code or system commands.`,\n\n    \"weak_hash\": `This code uses cryptographically weak hashing algorithms (MD5, SHA1) that are vulnerable to collision attacks and rainbow table lookups:\n\n‚Ä¢ MD5 and SHA1 are considered broken for security purposes\n‚Ä¢ Modern hardware can compute billions of hashes per second\n‚Ä¢ Precomputed hash tables (rainbow tables) exist for common inputs\n‚Ä¢ Collisions can be generated with reasonable computational effort\n\nFor security-sensitive applications, use stronger algorithms like SHA-256, SHA-3, or bcrypt for password hashing.`,\n\n    \"path_traversal\": `This code appears to be vulnerable to path traversal attacks, where attackers can access files outside the intended directory:\n\n‚Ä¢ Users can provide paths with \"../\" sequences to navigate up directories\n‚Ä¢ Sensitive system files may be accessible\n‚Ä¢ Application configuration files could be exposed\n‚Ä¢ The vulnerability can lead to information disclosure or code execution\n\nFile operations should validate and sanitize all path inputs to prevent directory traversal.\n\nIf no issues are found return []`\n  };\n\n  return descriptions[vulnerability.title] || vulnerability.description;\n}\n\nfunction generateSecureCodeFix(originalCode: string, vulnerability: Vulnerability): string {\n  const fixes: Record<string, (code: string) => string> = {\n    \"hardcoded_secrets\": (code: string) => {\n      let fixedCode = code;\n      \n      const patterns = [\n        { pattern: /(API_KEY|SECRET|PASSWORD|TOKEN)\\s*[:=]\\s*[\"']([^\"']+)[\"']/gi, \n          replacement: '$1 = process.env.$1 || \"\"' },\n        { pattern: /apiKey\\s*[:=]\\s*[\"']([^\"']+)[\"']/gi, \n          replacement: 'apiKey = process.env.API_KEY || \"\"' },\n        { pattern: /password\\s*[:=]\\s*[\"']([^\"']+)[\"']/gi, \n          replacement: 'password = process.env.PASSWORD || \"\"' }\n      ];\n      \n      patterns.forEach(({ pattern, replacement }) => {\n        fixedCode = fixedCode.replace(pattern, replacement);\n      });\n      \n      if (!fixedCode.includes('require(\"dotenv\")') && !fixedCode.includes('import dotenv')) {\n        fixedCode = 'require(\"dotenv\").config();\\n\\n' + fixedCode;\n      }\n      \n      return `// ‚úÖ Secure version - uses environment variables\n${fixedCode}\n\n// Add to your .env file:\n// API_KEY=your_actual_api_key_here\n// PASSWORD=your_actual_password_here`;\n    },\n\n    \"sql_string_interp\": (code: string) => {\n      let fixedCode = code;\n      fixedCode = fixedCode.replace(\n        /SELECT.*FROM.*WHERE.*\\$\\{.*\\}/gi,\n        'SELECT * FROM users WHERE id = ?'\n      );\n      \n      return `// ‚úÖ Secure version - uses parameterized queries\n${fixedCode}\n\n// Example with proper parameterization:\n// const query = 'SELECT * FROM users WHERE id = ? AND name = ?';\n// const results = await db.query(query, [userId, userName]);`;\n    },\n\n    \"eval_os_system\": (code: string) => {\n      let fixedCode = code;\n      fixedCode = fixedCode.replace(/eval\\s*\\([^)]+\\)/gi, '// eval() removed - use safer alternatives');\n      fixedCode = fixedCode.replace(/os\\.system\\s*\\([^)]+\\)/gi, '// os.system() removed - use subprocess with validation');\n      fixedCode = fixedCode.replace(/system\\s*\\([^)]+\\)/gi, '// system() removed - use safer alternatives');\n      \n      return `// ‚úÖ Secure version - removes dynamic code execution\n${fixedCode}\n\n// Safe alternatives:\n// - Instead of eval(): use JSON.parse() for data, or a proper parser\n// - Instead of system(): use child_process.spawn() with input validation`;\n    },\n\n    \"weak_hash\": (code: string) => {\n      let fixedCode = code;\n      fixedCode = fixedCode.replace(/md5\\s*\\(/gi, 'crypto.createHash(\"sha256\")');\n      fixedCode = fixedCode.replace(/sha1\\s*\\(/gi, 'crypto.createHash(\"sha256\")');\n      \n      return `// ‚úÖ Secure version - uses strong hashing\nconst crypto = require('crypto');\n${fixedCode}\n\n// For password hashing, use bcrypt:\n// const bcrypt = require('bcrypt');\n// const hashedPassword = await bcrypt.hash(password, 12);`;\n    },\n\n    \"path_traversal\": (code: string) => {\n      let fixedCode = code;\n      fixedCode = fixedCode.replace(\n        /(open\\s*\\(|fs\\.readFileSync\\s*\\(|readFile\\s*\\()[^,)]+/gi,\n        '$1path.resolve(SAFE_DIR, path.basename(filename))'\n      );\n      \n      return `// ‚úÖ Secure version - validates file paths\nconst path = require('path');\nconst SAFE_DIR = '/safe/directory';\n\n${fixedCode}\n\n// Additional security measures:\n// - Use path.resolve() and path.basename() to sanitize paths  \n// - Define an allowed directory and never go outside it`;\n    }\n  };\n\n  const fixFunction = fixes[vulnerability.title];\n  if (fixFunction) {\n    return fixFunction(originalCode);\n  }\n  \n  return `// ‚úÖ Secure version\n${originalCode}\n\n// General security recommendations:\n// - Validate and sanitize all inputs\n// - Use environment variables for secrets\n// - Apply principle of least privilege`;\n}\n\n/* ----------------------------\n   Enhanced repository scanning with Semgrep\n   ---------------------------- */\nexport async function scanRepository(owner: string, repo: string): Promise<ScanResult[]> {\n  const files = await fetchRepoFiles(owner, repo);\n  return await scanRepoFiles(files, true); // Enable enhanced scanning\n}\n\n/* ----------------------------\n   Example server handler usage (Next.js / Express)\n   ---------------------------- */\nexport async function handleScanRequest(req: any, res: any) {\n  try {\n    const { owner, repo, branch, enhanced = true } = req.body || req.query;\n    if (!owner || !repo) return res.status(400).json({ error: \"owner & repo required\" });\n\n    const files = await fetchRepoFiles(owner, repo, branch || \"main\");\n    if (!files.length) return res.status(200).json({ results: [] });\n\n    const results = await scanRepoFiles(files, enhanced);\n    return res.status(200).json({ \n      results, \n      scannedFiles: files.length,\n      enhancedScanEnabled: enhanced && !!OPENAI_KEY\n    });\n  } catch (err: any) {\n    console.error(\"scan error:\", err?.message || err);\n    return res.status(500).json({ error: err?.message || \"scan failed\" });\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1396, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 1465, "column": 0}, "map": {"version":3,"sources":["file:///Users/sanjithm/hunter-ai/src/app/%5B...slug%5D/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/[...slug]/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/[...slug]/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA8R,GAC3T,4DACA","debugId":null}},
    {"offset": {"line": 1479, "column": 0}, "map": {"version":3,"sources":["file:///Users/sanjithm/hunter-ai/src/app/%5B...slug%5D/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/[...slug]/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/[...slug]/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA0Q,GACvS,wCACA","debugId":null}},
    {"offset": {"line": 1493, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}